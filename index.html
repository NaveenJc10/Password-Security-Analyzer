<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Security Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(to bottom right, #0f172a, #581c87, #0f172a);
            min-height: 100vh;
        }
    </style>
</head>
<body class="p-6">
    <div class="max-w-4xl mx-auto">
        <div class="text-center mb-8">
            <div class="flex items-center justify-center gap-2 mb-2">
                <svg class="w-10 h-10 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                </svg>
                <h1 class="text-4xl font-bold text-white">Password Security Analyzer</h1>
            </div>
            <p class="text-gray-300">Analyze password strength and check for data breaches</p>
        </div>

        <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 mb-6 border border-white/20">
            <h2 class="text-2xl font-bold text-white mb-4 flex items-center gap-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                </svg>
                Analyze Your Password
            </h2>
            
            <input
                type="text"
                id="passwordInput"
                placeholder="Enter password to analyze..."
                class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-gray-400 border border-white/30 focus:outline-none focus:border-purple-400 mb-4"
            >

            <div id="strengthResult" class="hidden space-y-4">
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span id="strengthLabel" class="text-white font-medium"></span>
                        <span id="entropyLabel" class="text-gray-300 text-sm"></span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-3">
                        <div id="strengthBar" class="h-3 rounded-full transition-all"></div>
                    </div>
                </div>

                <div id="feedbackBox" class="hidden bg-red-500/20 border border-red-500/50 rounded-lg p-4">
                    <p class="text-white font-medium mb-2">Suggestions:</p>
                    <ul id="feedbackList" class="text-gray-200 space-y-1"></ul>
                </div>

                <button
                    id="checkBreachBtn"
                    class="w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2"
                >
                    Check if Password Has Been Breached
                </button>

                <div id="breachResult" class="hidden rounded-lg p-4"></div>
            </div>
        </div>

        <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20">
            <h2 class="text-2xl font-bold text-white mb-4 flex items-center gap-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                </svg>
                Generate Secure Password
            </h2>

            <div class="space-y-4">
                <div>
                    <label class="text-white font-medium mb-2 block">
                        Length: <span id="lengthValue">16</span>
                    </label>
                    <input
                        type="range"
                        id="lengthSlider"
                        min="8"
                        max="32"
                        value="16"
                        class="w-full"
                    >
                </div>

                <div class="grid grid-cols-2 gap-3">
                    <label class="flex items-center gap-2 text-white cursor-pointer">
                        <input type="checkbox" id="lowercase" checked class="w-4 h-4">
                        <span>Lowercase</span>
                    </label>
                    <label class="flex items-center gap-2 text-white cursor-pointer">
                        <input type="checkbox" id="uppercase" checked class="w-4 h-4">
                        <span>Uppercase</span>
                    </label>
                    <label class="flex items-center gap-2 text-white cursor-pointer">
                        <input type="checkbox" id="numbers" checked class="w-4 h-4">
                        <span>Numbers</span>
                    </label>
                    <label class="flex items-center gap-2 text-white cursor-pointer">
                        <input type="checkbox" id="symbols" checked class="w-4 h-4">
                        <span>Symbols</span>
                    </label>
                </div>

                <button
                    id="generateBtn"
                    class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2"
                >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    Generate Password
                </button>

                <div id="generatedBox" class="hidden">
                    <div class="bg-white/20 rounded-lg p-4 flex items-center justify-between gap-3">
                        <code id="generatedPassword" class="text-white font-mono text-lg break-all"></code>
                        <button
                            id="copyBtn"
                            class="bg-purple-600 hover:bg-purple-700 text-white p-2 rounded-lg transition-colors flex-shrink-0"
                            title="Copy to clipboard"
                        >
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                            </svg>
                        </button>
                    </div>
                    <p id="copyMessage" class="hidden text-green-400 text-sm text-center mt-2">Copied to clipboard!</p>
                </div>
            </div>
        </div>

        <div class="mt-6 text-center text-gray-400 text-sm">
            <p>All processing happens locally in your browser. Breach checking uses k-anonymity via Have I Been Pwned API.</p>
        </div>
    </div>

    <script>
        var passwordInput = document.getElementById('passwordInput');
        var strengthResult = document.getElementById('strengthResult');
        var strengthLabel = document.getElementById('strengthLabel');
        var entropyLabel = document.getElementById('entropyLabel');
        var strengthBar = document.getElementById('strengthBar');
        var feedbackBox = document.getElementById('feedbackBox');
        var feedbackList = document.getElementById('feedbackList');
        var checkBreachBtn = document.getElementById('checkBreachBtn');
        var breachResult = document.getElementById('breachResult');
        
        var lengthSlider = document.getElementById('lengthSlider');
        var lengthValue = document.getElementById('lengthValue');
        var generateBtn = document.getElementById('generateBtn');
        var generatedBox = document.getElementById('generatedBox');
        var generatedPassword = document.getElementById('generatedPassword');
        var copyBtn = document.getElementById('copyBtn');
        var copyMessage = document.getElementById('copyMessage');

        function analyzePassword(pwd) {
            var score = 0;
            var feedback = [];

            if (pwd.length >= 12) score += 2;
            else if (pwd.length >= 8) score += 1;
            else feedback.push("Use at least 12 characters");

            if (/[a-z]/.test(pwd)) score += 1;
            else feedback.push("Add lowercase letters");
            
            if (/[A-Z]/.test(pwd)) score += 1;
            else feedback.push("Add uppercase letters");
            
            if (/[0-9]/.test(pwd)) score += 1;
            else feedback.push("Add numbers");
            
            if (/[^a-zA-Z0-9]/.test(pwd)) score += 1;
            else feedback.push("Add symbols (!@#$%^&*)");

            var commonPatterns = ['123', 'abc', 'qwerty', 'password', 'admin'];
            var hasCommonPattern = false;
            for (var i = 0; i < commonPatterns.length; i++) {
                if (pwd.toLowerCase().indexOf(commonPatterns[i]) !== -1) {
                    hasCommonPattern = true;
                    break;
                }
            }
            if (hasCommonPattern) {
                score -= 2;
                feedback.push("Avoid common patterns");
            }

            if (/(.)\1{2,}/.test(pwd)) {
                score -= 1;
                feedback.push("Avoid repeated characters");
            }

            var charSetSize = 
                (/[a-z]/.test(pwd) ? 26 : 0) +
                (/[A-Z]/.test(pwd) ? 26 : 0) +
                (/[0-9]/.test(pwd) ? 10 : 0) +
                (/[^a-zA-Z0-9]/.test(pwd) ? 32 : 0);
            
            var entropy = pwd.length * Math.log2(charSetSize);

            var level = 'weak';
            var color = 'bg-red-500';
            if (score >= 6 && entropy >= 60) {
                level = 'strong';
                color = 'bg-green-500';
            } else if (score >= 4 && entropy >= 40) {
                level = 'medium';
                color = 'bg-yellow-500';
            }

            return { score: score, level: level, color: color, feedback: feedback, entropy: Math.round(entropy) };
        }

        passwordInput.addEventListener('input', function(e) {
            var pwd = e.target.value;
            breachResult.classList.add('hidden');
            
            if (!pwd) {
                strengthResult.classList.add('hidden');
                return;
            }

            var analysis = analyzePassword(pwd);
            strengthResult.classList.remove('hidden');
            strengthLabel.textContent = 'Strength: ' + analysis.level.toUpperCase();
            entropyLabel.textContent = 'Entropy: ' + analysis.entropy + ' bits';
            
            strengthBar.className = 'h-3 rounded-full transition-all ' + analysis.color;
            strengthBar.style.width = Math.min((analysis.score / 7) * 100, 100) + '%';

            if (analysis.feedback.length > 0) {
                feedbackBox.classList.remove('hidden');
                feedbackList.innerHTML = analysis.feedback.map(function(f) { return '<li>â€¢ ' + f + '</li>'; }).join('');
            } else {
                feedbackBox.classList.add('hidden');
            }
        });

        checkBreachBtn.addEventListener('click', function() {
            var pwd = passwordInput.value;
            if (!pwd) return;

            checkBreachBtn.textContent = 'Checking...';
            checkBreachBtn.disabled = true;

            var encoder = new TextEncoder();
            var data = encoder.encode(pwd);
            crypto.subtle.digest('SHA-1', data).then(function(hashBuffer) {
                var hashArray = Array.from(new Uint8Array(hashBuffer));
                var hashHex = hashArray.map(function(b) { return b.toString(16).padStart(2, '0'); }).join('').toUpperCase();
                
                var prefix = hashHex.substring(0, 5);
                var suffix = hashHex.substring(5);
                
                return fetch('https://api.pwnedpasswords.com/range/' + prefix).then(function(response) {
                    return response.text().then(function(text) {
                        var hashes = text.split('\n');
                        var found = null;
                        for (var i = 0; i < hashes.length; i++) {
                            if (hashes[i].startsWith(suffix)) {
                                found = hashes[i];
                                break;
                            }
                        }
                        
                        breachResult.classList.remove('hidden');
                        
                        if (found) {
                            var count = parseInt(found.split(':')[1]);
                            breachResult.className = 'rounded-lg p-4 bg-red-500/20 border border-red-500/50';
                            breachResult.innerHTML = '<div class="flex items-start gap-2"><svg class="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div><p class="text-white font-medium">Password Found in Breach Database</p><p class="text-gray-200 text-sm">This password appeared ' + count.toLocaleString() + ' times in known data breaches. Do not use it!</p></div></div>';
                        } else {
                            breachResult.className = 'rounded-lg p-4 bg-green-500/20 border border-green-500/50';
                            breachResult.innerHTML = '<div class="flex items-start gap-2"><svg class="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div><p class="text-white font-medium">Password Not Found in Breaches</p><p class="text-gray-200 text-sm">This password has not been found in known data breaches.</p></div></div>';
                        }

                        checkBreachBtn.textContent = 'Check if Password Has Been Breached';
                        checkBreachBtn.disabled = false;
                    });
                });
            }).catch(function(error) {
                breachResult.classList.remove('hidden');
                breachResult.className = 'rounded-lg p-4 bg-yellow-500/20 border border-yellow-500/50';
                breachResult.innerHTML = '<p class="text-white">Error checking breach database. Please try again.</p>';
                checkBreachBtn.textContent = 'Check if Password Has Been Breached';
                checkBreachBtn.disabled = false;
            });
        });

        lengthSlider.addEventListener('input', function(e) {
            lengthValue.textContent = e.target.value;
        });

        generateBtn.addEventListener('click', function() {
            var length = parseInt(lengthSlider.value);
            var charset = '';
            
            if (document.getElementById('lowercase').checked) charset += 'abcdefghijklmnopqrstuvwxyz';
            if (document.getElementById('uppercase').checked) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (document.getElementById('numbers').checked) charset += '0123456789';
            if (document.getElementById('symbols').checked) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';

            if (charset === '') charset = 'abcdefghijklmnopqrstuvwxyz';

            var array = new Uint8Array(length);
            crypto.getRandomValues(array);
            
            var pwd = '';
            for (var i = 0; i < array.length; i++) {
                pwd += charset[array[i] % charset.length];
            }
            
            generatedPassword.textContent = pwd;
            generatedBox.classList.remove('hidden');
            copyMessage.classList.add('hidden');
        });

        copyBtn.addEventListener('click', function() {
            navigator.clipboard.writeText(generatedPassword.textContent);
            copyMessage.classList.remove('hidden');
            setTimeout(function() { copyMessage.classList.add('hidden'); }, 2000);
        });
    </script>
</body>
</html>
